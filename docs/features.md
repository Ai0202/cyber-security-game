# 機能一覧

## トップ画面（ストーリー選択）

### 概要
ゲームのエントリーポイント。ストーリー（攻撃テーマ）を選んでプレイするか、コンポーネント単体で練習するかを選択する。

### 構成
- **ストーリー一覧セクション**: 各ストーリーがカード形式で表示される
- **練習モードセクション**: コンポーネント（攻撃手法）を個別に選んで練習できる

### ユーザーストーリー
- プレイヤーとして、攻撃テーマ（ストーリー）を選んで一連の攻撃チェーンを体験したい
- プレイヤーとして、特定の攻撃手法（コンポーネント）だけ練習したい

### 受け入れ条件
- ストーリーカードに名前・説明・難易度・業界が表示される
- ストーリーカードタップでストーリー詳細画面へ遷移する
- 練習モードセクションでコンポーネント一覧が表示される
- Framer Motion でカードのホバー・タップアニメーションが動作する

---

## ストーリー詳細画面

### 概要
選択したストーリーの詳細情報と、今回ランダム決定されたコンポーネント構成を確認してゲームを開始する。

### 表示内容
- ストーリータイトル・説明
- ターゲット組織情報（業界、組織名、概要）
- 今回のフェーズ構成（4フェーズ × 選ばれたコンポーネント）をタイムライン表示
- START ボタン

### ユーザーストーリー
- プレイヤーとして、今回の攻撃ミッションの全体像を把握してからプレイを開始したい

### 受け入れ条件
- ストーリーコンテキスト（業界・ターゲット組織）が表示される
- フェーズタイムラインに4つのフェーズとそれぞれのコンポーネントが表示される
- START ボタンでゲーム進行画面へ遷移する

---

## ゲーム進行画面

### 概要
4フェーズを順番にプレイする画面。各フェーズで選ばれたコンポーネントのUIが表示され、フェーズ間はサイバーパンク風の遷移演出が入る。

### フロー
1. Phase 1 コンポーネント → フェーズ遷移演出
2. Phase 2 コンポーネント → フェーズ遷移演出
3. Phase 3 コンポーネント → フェーズ遷移演出
4. Phase 4 コンポーネント → セッション結果画面へ

### ユーザーストーリー
- プレイヤーとして、攻撃チェーンを順番に体験し、前のフェーズの成果が次に活かされる一連のストーリーを楽しみたい

### 受け入れ条件
- 各フェーズのコンポーネントが正しくロードされる
- フェーズ間で遷移演出が表示される
- 前フェーズの contextOutput が次フェーズに引き継がれる
- 現在のフェーズ番号・全体の進行度が表示される

---

## フェーズ定義

### Phase 1: 情報収集（RECONNAISSANCE）
ターゲットの情報を集めるフェーズ。

### Phase 2: 認証窃取（CREDENTIAL THEFT）
ID/パスワード等の認証情報を手に入れるフェーズ。

### Phase 3: 侵入（INTRUSION）
システムに侵入し、権限を昇格するフェーズ。

### Phase 4: 目的達成（OBJECTIVE）
最終目的（暗号化・データ窃取等）を遂行するフェーズ。

---

## コンポーネント一覧

### ショルダーハッキング（SHOULDER HACKING）

#### フェーズ: 情報収集（recon）
#### 難易度: ★☆☆（初級）

#### 概要
攻撃者として、オフィスや公共の場でターゲットのPC画面・スマホ画面を覗き見して機密情報を盗む体験。

#### ゲーム形式: インタラクティブ観察ゲーム（制限時間つき画像探索）

#### ゲームフロー
1. **シーン提示**: Gemini APIがストーリーコンテキストに合わせたシチュエーションを生成
2. **画面表示**: ターゲットのPC/スマホ画面が部分的に見えている画像（UIモック）が表示される
3. **情報探索**: 制限時間（30秒）以内に、画面上の機密情報（パスワード付箋、メール本文、個人情報など）をタップして収集する
4. **スコア判定**: 見つけた情報の数と重要度でスコアリング

#### contextOutput（次フェーズへの引き継ぎ）
- 発見したメールアドレス、パスワードのヒント、社内システムURL等

#### Gemini API活用
- ストーリーコンテキスト（業界・ターゲット組織）に合わせたシチュエーション生成
- 画面上に表示される情報のテキストを動的生成
- クリア後に「この情報がどう悪用されるか」のフィードバックを生成

#### スコアリング
| 項目 | 点数 |
|------|------|
| パスワード発見 | 30pt |
| 個人情報発見 | 20pt |
| 業務機密発見 | 25pt |
| 制限時間内クリア | ボーナス 10pt |

#### 学習ポイント（結果画面で表示）
- プライバシーフィルターの重要性
- 公共の場でのPC操作時の注意
- パスワードを付箋に書かない

---

### パスワードクラッキング（PASSWORD CRACKING）

#### フェーズ: 認証窃取（credential）
#### 難易度: ★★☆（中級）

#### 概要
攻撃者として、ターゲットの弱いパスワードを総当たり・辞書攻撃で突破する体験。

#### ゲーム形式: パスワード推測シミュレーション（ターミナル風UI）

#### ゲームフロー
1. **ターゲット情報表示**: Gemini APIがターゲットのSNSプロフィール（誕生日・ペット名・趣味等）を生成
2. **パスワード推測**: ターゲットの情報をヒントに、パスワード候補を入力する
3. **攻撃実行**: 入力したパスワードで「攻撃」ボタンを押すと、ハッキング風のターミナルアニメーションが流れる
4. **結果表示**: パスワードが合っていれば突破成功。何回目の試行で突破できたかをスコアリング

#### 攻撃手法の選択肢
- **手動推測**: ターゲットの個人情報から推測して入力（高得点）
- **辞書攻撃モード**: よくあるパスワード一覧から選択して自動実行（中得点）
- **総当たりモード**: 文字種と長さを指定して自動実行 → かかる時間をシミュレーション表示（低得点だが教育効果大）

#### contextOutput（次フェーズへの引き継ぎ）
- 突破したパスワード、アカウント情報

#### Gemini API活用
- ストーリーコンテキストに合わせたターゲットプロフィール生成
- プロフィールから推測可能なパスワードとその理由を内部で保持
- 突破後に「なぜこのパスワードは弱かったのか」の解説を生成

#### スコアリング
| 項目 | 点数 |
|------|------|
| 1回目で突破 | 100pt |
| 2〜3回目で突破 | 70pt |
| 4〜5回目で突破 | 40pt |
| 総当たりで突破 | 10pt |
| 辞書攻撃で突破 | 20pt |

#### 学習ポイント（結果画面で表示）
- 個人情報から推測可能なパスワードの危険性
- パスワードの長さ・複雑さと突破時間の関係
- パスワードマネージャーの推奨
- 二要素認証の重要性

---

### フィッシング攻撃（PHISHING）

#### フェーズ: 認証窃取（credential）
#### 難易度: ★★☆（中級）

#### 概要
攻撃者として、ターゲットを騙すフィッシングメールを作成し、情報を窃取する体験。

#### ゲーム形式: フィッシングメール作成シミュレーション（メーラー風UI）

#### ゲームフロー
1. **ミッションブリーフィング**: ターゲットの企業情報・役職・最近の行動が Gemini API で生成される
2. **メール作成**: 以下の要素をプレイヤーが選択・入力してフィッシングメールを組み立てる
   - **送信者名/メールアドレス**: なりすまし先を選択（上司、IT部門、銀行、配送業者等）
   - **件名**: 緊急性・重要性を感じさせる件名を入力
   - **本文**: テンプレートをベースにカスタマイズ、または自由入力
   - **罠リンク/添付ファイル**: 偽のURL・偽の添付ファイルを設定
3. **送信 → 判定**: Gemini APIがターゲットの反応をシミュレーション
4. **スコア判定**: メールの巧妙さを複数の観点で評価

#### contextOutput（次フェーズへの引き継ぎ）
- 窃取した認証情報（ID/パスワード）、ターゲットのアクション結果

#### Gemini API活用
- ストーリーコンテキストに合わせたターゲット情報生成
- プレイヤーが作成したフィッシングメールの「騙されやすさ」をAIが多角的に評価
- ターゲットのリアクションをストーリー形式で生成
- 「このメールのどこが見破れるポイントだったか」の防御側フィードバックを生成

#### スコアリング
| 項目 | 点数 |
|------|------|
| 送信者偽装の巧妙さ | 0〜25pt |
| 件名の緊急性・自然さ | 0〜25pt |
| 本文の説得力 | 0〜30pt |
| 罠URL/添付の巧妙さ | 0〜20pt |

#### 学習ポイント（結果画面で表示）
- フィッシングメールの典型的な特徴
- メールアドレスのドメイン確認方法
- URLの確認方法（ホバーして実際のリンク先を見る）
- 「緊急」「至急」に惑わされない心構え
- 不審メールの報告フロー

---

### ネットワーク侵入（NETWORK INTRUSION）

#### フェーズ: 侵入（intrusion）
#### 難易度: ★★★（上級）

#### 概要
攻撃者として、入手した認証情報で企業ネットワークに侵入し、内部偵察と権限昇格を行う体験。

#### ゲーム形式: ネットワークマップ探索 + ターミナル風UI

#### ゲームフロー
1. **初期ログイン**: 前フェーズで入手した認証情報でシステムにログイン
2. **内部偵察**: ネットワークマップ上のノード（PC、ファイルサーバー、管理者端末等）をクリックして探索
3. **権限昇格**: 管理者権限の取得を試みる選択肢から選択
4. **結果判定**: 探索範囲と権限取得の手法でスコアリング

#### contextOutput（次フェーズへの引き継ぎ）
- 取得した権限レベル、発見したサーバー・ファイル情報、ステルス度

#### Gemini API活用
- ストーリーコンテキストに合わせた企業ネットワーク構成を動的生成
- 探索行動に応じた発見情報・検知リスクを生成
- 「ここで検知される可能性があった」ポイントを記録

#### スコアリング
| 項目 | 点数 |
|------|------|
| 初期侵入の成功 | 20pt |
| 偵察で重要情報を発見 | 0〜30pt |
| 権限昇格の手法 | 0〜25pt |
| ステルス維持 | 0〜25pt |

#### 学習ポイント（結果画面で表示）
- ネットワーク分離の重要性
- 最小権限の原則
- 不審なアクセスの検知方法
- アクセスログ監視の重要性

---

### ランサムウェア展開（RANSOMWARE）

#### フェーズ: 目的達成（objective）
#### 難易度: ★★★（上級）

#### 概要
攻撃者として、侵入したネットワーク上でランサムウェアを展開し、データを暗号化して身代金を要求する体験。

#### ゲーム形式: ファイル暗号化シミュレーション + 脅迫文作成

#### ゲームフロー
1. **暗号化対象選択**: 前フェーズで発見したサーバー・ファイルから暗号化対象を選択
2. **暗号化実行**: ファイルアイコンが次々とロックアイコンに変わるアニメーション
3. **脅迫文作成**: 身代金要求メッセージを作成（テンプレートカスタマイズ）
4. **結果判定**: 暗号化範囲・脅迫文の巧妙さでスコアリング

#### Gemini API活用
- 前フェーズの contextOutput を活用した暗号化シナリオ生成
- 脅迫文の「効果」を評価
- 全フェーズの行動ログから最終評価レポートを生成
- 「バックアップがあれば復旧できた」等の防御側フィードバック

#### スコアリング
| 項目 | 点数 |
|------|------|
| 暗号化対象の選択 | 0〜30pt |
| バックアップ無効化 | 0〜25pt |
| 脅迫文の巧妙さ | 0〜20pt |
| ステルス維持 | 0〜25pt |

#### 学習ポイント（結果画面で表示）
- ランサムウェア攻撃の全体像（キルチェーン）
- バックアップの重要性（3-2-1ルール）
- インシデント対応の基本フロー
- 身代金を払ってはいけない理由

---

## セッション結果画面

### 概要
全4フェーズ完了後に表示される総合評価画面。

### 表示内容
- **総合スコア**: 全フェーズの合算スコアを円形プログレスバーで表示
- **ランク判定**: S / A / B / C / D のランク表示（アニメーション付き）
- **フェーズ別スコア**: 各フェーズのスコア内訳をカード形式で表示
- **攻撃チェーンサマリー**: 今回のストーリーでの攻撃フローを図示
- **AIフィードバック**: Gemini APIによる行動分析・学習ポイントの個別フィードバック（ストリーミング表示）
- **防御のヒント**: 攻撃をどう防ぐかの具体的なアドバイス
- 「もう一度プレイ」（同じストーリー、異なるコンポーネント構成）ボタン
- 「ストーリー選択に戻る」ボタン

### ランク判定基準
| ランク | スコア範囲 |
|--------|-----------|
| S | 90-100 |
| A | 70-89 |
| B | 50-69 |
| C | 30-49 |
| D | 0-29 |

---

## 共通機能

### スコアリング
- 各コンポーネント: 0〜100点
- セッション全体: 各フェーズスコアの平均
- ランク判定: S (90-100), A (70-89), B (50-69), C (30-49), D (0-29)

### 練習モード
- トップ画面からコンポーネント単体を選んでプレイ可能
- ストーリーコンテキストなしで、コンポーネント固有のデフォルトシナリオを使用
- 練習モードのスコアはセッションに含まない
